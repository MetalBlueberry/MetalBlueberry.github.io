<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.59.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Python Jupyter Notebook With Plotly Support&nbsp;&ndash;&nbsp;MetalBlueberry</title><link rel="stylesheet" href="/css/core.min.97dca4f10b4a76a5c62d6c5855e9eaab3b083ba20b6e4059f24dc20a8bb331c418ecdfd5449a29ef5333ebc2c64b286b.css" integrity="sha384-l9yk8QtKdqXGLWxYVenqqzsIO6ILbkBZ8k3CCouzMcQY7N/VRJop71Mz68LGSyhr"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python Jupyter Notebook With Plotly Support"/>
<meta name="twitter:description" content="Python is awesome because you can do anything. In this case, I&rsquo;m going to show you how to configure a Jupyter notebook with integrated Plotly support to draw interactive graphs. This is very useful if you have to analyse something."/>

<meta property="og:title" content="Python Jupyter Notebook With Plotly Support" />
<meta property="og:description" content="Python is awesome because you can do anything. In this case, I&rsquo;m going to show you how to configure a Jupyter notebook with integrated Plotly support to draw interactive graphs. This is very useful if you have to analyse something." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://metalblueberry.github.io/post/howto/2019-12-01_python_jupyter_notebook_with_plotly_support/" />
<meta property="article:published_time" content="2019-12-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-10T11:39:35+02:00" />

<meta name="author" content="MetalBlueberry">

<script src="https://cdn.plot.ly/plotly-1.50.0.min.js"></script>
<body>
    <div class="base-body"><section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img class="site logo" src="/android-chrome-512x512.png" alt /><span class="site name">MetalBlueberry</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/about">About</a><a class="nav item" href="/social">Follow me</a></nav></div></span></div><div class="site slogan"><span class="title">A passionate programmer</span></div></section><div id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Python Jupyter Notebook With Plotly Support</h1><p class="article date">Saturday, December 7, 2019<span class="lastmod"> • edited Friday, April 10, 2020</span></p></section><article class="article markdown-body"><p>Python is awesome because you can do anything. In this case, I&rsquo;m going to show you how to configure a Jupyter notebook with integrated Plotly support to draw interactive graphs. This is very useful if you have to analyse something.</p>

<h1 id="introduction">Introduction</h1>

<p>In case you don&rsquo;t know it, the <a href="https://jupyter.org/">Jupyter project</a> exist to develop open-source software, open-standards, and services for interactive computing across dozens of programming languages. All started with Python and R, but nowadays, it is compatible with almost any popular language.</p>

<p>I&rsquo;m going to focus in how to create a Jupyter notebook for Python using a Docker image. This will allow you to replicate the environment wherever you want with a single command and keep all the dependencies in a single place.</p>

<p>One of the key things is that I&rsquo;m going to explain how to integrate the Plotly library into the notebook so we will be able to create interactive plots that can be exported with the notebook itself. This create an amazing tool to share reports within your organization.</p>

<h2 id="docker-environment">Docker environment</h2>

<p>Finding the images is easy. If you google it, you will find the repository <a href="https://github.com/jupyter/docker-stacks">jupyter/docker-stacks</a> that contains the images that you need. but, what do you need? The Jupyter environment is growing fast and sometimes is hard to know what are we looking for. The best place to start, as always, is the <a href="https://jupyter-docker-stacks.readthedocs.io/en/latest/">documentation</a> page. Skipping the examples that shows you how to create a notebook in a single command, I&rsquo;m going to enter directly in the section &ldquo;<a href="https://jupyter-docker-stacks.readthedocs.io/en/latest/using/selecting.html">Selecting an image</a>&rdquo; to understand the difference and select what we need. Go to the link to read about the images and then come back here. Keep in mind that I&rsquo;m looking for a Python environment with at least Pandas and Plotly installed.</p>

<p>The image &ldquo;jupyter/base-notebook&rdquo; could be a good options, but there are still useful missing dependencies provided by &ldquo;jupyter/minimal-notebook&rdquo;. &ldquo;jupyter/r-notebook&rdquo; is discarded, we want Python. &ldquo;jupyter/scipy-notebook&rdquo; contains everything we need except Plotly. It even contain more things that we need, like seaborn. The following images diverge further more from our needs so I&rsquo;m going to use the jupyter/minimal-notebook and install the dependencies myself. Let&rsquo;s create a Docker container.</p>

<h3 id="the-base-image">The Base Image</h3>

<p>The documentation warns that the images are regularly updated with backward incompatible changes. For this reason, it is recommendable to use a constant docker tag instead of the $LATEST reference. You can go directly to <a href="https://hub.docker.com/r/jupyter/minimal-notebook/tags/">docker hub</a> and find the current latest tag to start a new project. In this moment, the tag is &ldquo;jupyter/minimal-notebook:ad3574d3c5c7&rdquo;. Let&rsquo;s download it and create a minimal notebook. The following command will do it.</p>

<pre><code class="language-sh">docker run -p 8888:8888 jupyter/minimal-notebook:ad3574d3c5c7
</code></pre>

<p>When it finishes, you will have the notebook running in <a href="http://localhost:8888">http://localhost:8888</a>. Check it out. The notebook requires you to give the token that has been printed in the terminal. Just copy and paste it.</p>

<p>Now you can create a new Python notebook by clicking on the top left button &ldquo;new&rdquo; and selecting &ldquo;Python 3&rdquo;. This will open a new windows and you will be ready to go. Try to type a few Python commands and press <code>Shift+Enter</code>. This will execute the command and move to the next cell.</p>

<pre><code class="language-Python">print(&quot;Hello world!&quot;)
</code></pre>

<p>This is cool, but we need a lot of dependencies. If you try to run <code>import pandas</code>, it will complain. To install the dependencies, we need a Dockerfile and a requirements.txt.</p>

<h3 id="the-docker-file">The Docker file</h3>

<p>It is time to create a folder somewhere in your system to put everything on it. I would recommend you to put it under VSC with git. The first thing you should create is a <code>Dockerfile</code> and a <code>requirements.txt</code> with the following content.</p>

<pre><code class="language-Dockerfile">FROM jupyter/minimal-notebook:ad3574d3c5c7

WORKDIR /tml
COPY requirements.txt .
RUN pip install -r requirements.txt
</code></pre>

<pre><code class="language-txt">pandas
plotly
</code></pre>

<p>Now we can give it a try by building and running the container.</p>

<pre><code class="language-sh"># from the folder containing the files
docker build -t jupyter .
docker run --rm -it -p 8888:8888 jupyter 
</code></pre>

<div class="admonition tip"><p class="admonition-title">tip</p>
  
<ul>
<li><code>--rm</code> deletes the container at exit.</li>
<li><code>-it</code> creates an interactive tty. is not necessary but i like to run containers with it when I&rsquo;m exploring.</li>
<li><code>-p 8888:8888</code> exposes the port 8888 to my localhost.</li>
<li><code>jupyter</code> is the name of the image given by me when building it</li>
</ul>


</div>

<p>This will print in the terminal a series of messages. You should look for the one displaying the localhost URL and the token. If you click the link, It will open the browser with your new jupyter notebook environment.</p>

<pre><code class="language-log">[I 09:32:25.749 NotebookApp] The Jupyter Notebook is running at:
[I 09:32:25.749 NotebookApp] http://75fcb2e2b029:8888/?token=da7ef85e9afb1568794b3c222f633c144ba9c010f9de26b2
[I 09:32:25.749 NotebookApp]  or http://127.0.0.1:8888/?token=da7ef85e9afb1568794b3c222f633c144ba9c010f9de26b2
</code></pre>

<p>So it is done! We can star playing with it.</p>

<h3 id="enable-jupyterlab-optional">Enable JupyterLab (Optional)</h3>

<p>Looks like the world is always moving and now we have the JupyterLab web interface instead of the classic Jupyter Notebook. We can easily enable it by adding an environment variable at the end of the Dockerfile. It is still a little bit unstable but I think that It will be quickly improved.</p>

<p>Also, I&rsquo;ve added some essential extensions for me directly in the dockerfile.</p>

<pre><code class="language-Dockerfile">ENV JUPYTER_ENABLE_LAB=yes

RUN jupyter labextension install jupyterlab_vim &amp;&amp; \
    jupyter labextension install @jupyterlab/dataregistry-extension &amp;&amp; \
    pip install --upgrade jupyterlab-git &amp;&amp; \
    jupyter lab build
</code></pre>

<p>From my point of view, this is a must just for the vim extension.</p>

<h2 id="setting-up-plotly">Setting up Plotly</h2>

<p>By default, Plotly should work without any extra setup. The problem is that in some occasions you have to change the render configuration. This is really well explained in the <a href="https://plot.ly/python/renderers/">Plotly Renderers</a> documentation. You can use the following snippet to check your default render and to modify it</p>

<pre><code class="language-python"># [0]
# print
import plotly.io as pio
pio.renderers

# [1]
# modify
pio.renderers.default = &quot;iframe&quot;
</code></pre>

<p>It&rsquo;s time to run a sample code to see if we can draw a plot. Just copy and paste this into a cell.</p>

<pre><code class="language-py">import plotly.graph_objects as go
fig = go.Figure(
    data=[go.Bar(y=[2, 1, 3])],
    layout_title_text=&quot;A Figure Displaying Itself&quot;
)
fig.show()
</code></pre>

<p>You should see something like this, but with a different style.</p>

<div class="figure">
<div class="figure-plot" id="fig1">
	Code could not finish, this are some reasons why this happen.
	- Plot name not defined. The first parameter of the shortcode is the name.
	- There is a syntax error. check browser console.
</div>
<script>
  function draw(){
	test = document.getElementById("fig1");
	if (test == null){
		console.log("The plot name is not defined")
		return
	}

	fig = null
	
fig = {
    "data": [
        {
            "type": "bar",
            "y": [ 2, 1, 3 ]
        }
    ],
    "layout": {
        "title": "A Figure Displaying Itself"
    }
}


	if (!fig) {
		test.innerText = "ERROR: fig variable is not defined"
		return
	}
	test.innerText = null
	Plotly.plot(test ,fig);
  }
  draw()
</script>
</div>

<h3 id="dict-syntax-vs-graph-objects">Dict syntax vs graph_objects</h3>

<p>In the previous example, the figure is build using the <code>graph_objects</code>. This is not a bad idea, but for simple cases, I prefer to create the dict by my self. This is basically the same idea. Let&rsquo;s compare.</p>

<div class="admonition tip"><p class="admonition-title">tip</p>
  
<p>Quoting the docs [Creating and Updating Figures]:</p>

<p><em>The goal of plotly.py is to provide a pleasant Python interface for creating figure specifications for display in the Plotly.js JavaScript library. In Plotly.js, a figure is specified by a declarative JSON data structure, and so <strong>the ultimate responsibility of plotly.py is to produce Python dictionaries that can be serialized into a JSON data structure that represents a valid figure</strong>.</em></p>


</div>

<pre><code class="language-python">import plotly.io as pio
fig = {
    &quot;data&quot;: [
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;y&quot;: [ 2, 1, 3 ]
        }
    ],
    &quot;layout&quot;: {
        &quot;title&quot;: &quot;A Figure Displaying Itself&quot;
    }
}
pio.show(fig)

</code></pre>

<pre><code class="language-python">import plotly.graph_objects as go
fig = go.Figure(
    data=[
      go.Bar(
        y=[2, 1, 3]
      )
    ],
    layout_title_text=&quot;A Figure Displaying Itself&quot;
)
fig.show()
</code></pre>

<p>If you want to get the json representation of the <code>graph_objects</code>, there is a method <code>to_json</code> that is what you expect. There is also an option to convert the dict to a <code>graph_objects</code> using <code>go.Figure</code> and passing the dictionary as parameter.</p>

<h2 id="working-with-pandas">Working with Pandas</h2>

<p>The next big question is. How do we draw pandas dataframes? Thankfully, we have Python List Comprehensions that make things much easier. First let&rsquo;s fetch some data. I&rsquo;ve chossen data from Airbnb Barcelona from <a href="http://insideairbnb.com/get-the-data.html">here</a>.
Loading the data is straight forward thanks to pandas. The second instructions is to parse the price values into float values to allow calculations.</p>

<pre><code class="language-py">import pandas as pd
df = pd.read_csv(&quot;http://data.insideairbnb.com/spain/catalonia/barcelona/2019-09-17/data/listings.csv.gz&quot;)
df[&quot;price_value&quot;] = df.price.replace('[\$,]', '', regex=True).astype(float)
</code></pre>

<p>Okey, now let&rsquo;s draw the mean price of a room based on the number of room. I like to wrap my plots with a function, but this is just personal preference.</p>

<pre><code class="language-py">def beds_vs_meanprice(df: pd.DataFrame):
    data = df.groupby(&quot;beds&quot;,as_index=False)[&quot;price_value&quot;].mean()
    fig = {
        &quot;data&quot;:[
            {
                &quot;type&quot;: &quot;bar&quot;,
                &quot;x&quot;:data[&quot;beds&quot;],
                &quot;y&quot;:data[&quot;price_value&quot;]
            }
        ]
    }
    pio.show(fig)
beds_vs_meanprice(df)
</code></pre>

<p>This produces an ugly plot, but let&rsquo;s focus on just the data for now.</p>

<div class="figure">
<div class="figure-plot" id="airbnb">
	Code could not finish, this are some reasons why this happen.
	- Plot name not defined. The first parameter of the shortcode is the name.
	- There is a syntax error. check browser console.
</div>
<script>
  function draw(){
	test = document.getElementById("airbnb");
	if (test == null){
		console.log("The plot name is not defined")
		return
	}

	fig = null
	
fig = {"data": [{"type": "bar", "x": [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 18.0, 19.0, 20.0, 23.0, 24.0, 25.0, 26.0, 28.0, 30.0], "y": [122.85340314136126, 91.16547917711992, 114.47470915528578, 197.531164249314, 197.89040318001136, 190.08771929824562, 222.9758620689655, 251.88349514563106, 463.08620689655174, 391.8727272727273, 499.4423076923077, 344.22222222222223, 755.1666666666666, 613.8, 350.8666666666667, 336.8888888888889, 431.7857142857143, 440.0, 628.0, 453.0, 500.0, 550.0, 545.5, 740.0, 15.0, 483.0]}]}


	if (!fig) {
		test.innerText = "ERROR: fig variable is not defined"
		return
	}
	test.innerText = null
	Plotly.plot(test ,fig);
  }
  draw()
</script>
</div>

<p>This is really easy to follow, you just have to put the columns that you want to draw and it works! Provably you will find yourself wanting to add categories, so let&rsquo;s do it. This is where list comprehension is essential. Let&rsquo;s include a category by the cancellation policy.</p>

<pre><code class="language-py">def beds_vs_meanprice(df: pd.DataFrame):
    data = df.groupby([&quot;cancellation_policy&quot;,&quot;beds&quot;],as_index=False)[&quot;price_value&quot;].mean()
    fig = {
        &quot;data&quot;:[
            {
                &quot;type&quot;: &quot;bar&quot;,
                &quot;x&quot;:data[data[&quot;cancellation_policy&quot;]==policy][&quot;beds&quot;],
                &quot;y&quot;:data[data[&quot;cancellation_policy&quot;]==policy][&quot;price_value&quot;],
                &quot;name&quot;:policy
            } for policy in data[&quot;cancellation_policy&quot;].unique()
        ]
    }
    pio.show(fig)
beds_vs_meanprice(df)
</code></pre>

<div class="figure">
<div class="figure-plot" id="airbnb2">
	Code could not finish, this are some reasons why this happen.
	- Plot name not defined. The first parameter of the shortcode is the name.
	- There is a syntax error. check browser console.
</div>
<script>
  function draw(){
	test = document.getElementById("airbnb2");
	if (test == null){
		console.log("The plot name is not defined")
		return
	}

	fig = null
	
fig = {"data": [{"type": "bar", "x": [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 12.0, 14.0, 15.0, 16.0], "y": [58.049180327868854, 137.5415173237754, 138.96512935883015, 393.92602040816325, 293.5128205128205, 357.9247311827957, 210.82432432432432, 155.11764705882354, 1966.3333333333333, 358.42857142857144, 1050.3846153846155, 4160.0, 454.75, 146.0, 805.0], "name": "flexible"}, {"type": "bar", "x": [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 16.0, 18.0, 26.0, 28.0], "y": [89.23809523809524, 65.87909209951987, 116.96257796257797, 187.15055467511885, 208.99554565701558, 189.24479166666666, 258.75, 387.48936170212767, 256.4347826086956, 431.75, 258.0, 30.0, 107.5, 899.0, 20.0, 25.0, 300.0, 740.0, 15.0], "name": "moderate"}, {"type": "bar", "x": [1.0], "y": [42.5], "name": "strict"}, {"type": "bar", "x": [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 18.0, 19.0, 20.0, 23.0, 24.0, 25.0, 30.0], "y": [183.8181818181818, 64.93736903376019, 99.97269624573379, 138.1967654986523, 161.53831231813774, 160.23861566484518, 210.30085959885386, 214.05797101449275, 257.85714285714283, 385.0833333333333, 328.4375, 383.5, 361.2857142857143, 542.5, 342.4, 391.42857142857144, 484.44444444444446, 580.0, 628.0, 453.0, 500.0, 550.0, 545.5, 483.0], "name": "strict_14_with_grace_period"}, {"type": "bar", "x": [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0], "y": [625.6923076923077, 222.1764705882353, 615.170731707317, 386.4418604651163, 234.85714285714286, 236.15384615384616, 374.75, 1092.25], "name": "super_strict_30"}, {"type": "bar", "x": [1.0, 2.0, 3.0, 4.0], "y": [595.6666666666666, 200.0, 361.6666666666667, 700.25], "name": "super_strict_60"}]}


	if (!fig) {
		test.innerText = "ERROR: fig variable is not defined"
		return
	}
	test.innerText = null
	Plotly.plot(test ,fig);
  }
  draw()
</script>
</div>

<p>This may look complicated, but the idea behind is really simple. We get the unique policy values and create a trace for each one. To select the appropriate data, we filter the dataframe by the given policy. To identify it, we assign the trace name the value of the policy.</p>

<p>with this technique, you can draw almost anything in a dataframe using plotly. If you are familiar with working with big datasets, you may notice that working in this way is not efficient. The good new are that you will hit plotly limitations before you have to think a better way of generating the plot.</p>

<h3 id="export-figure-as-json">Export figure as json</h3>

<p>To draw the figures in the blog, I&rsquo;ve exported the figure in json format and used the <a href="https://metalblueberry.github.io/post/howto/2019-11-23_add_plots_with_hugo_shortcodes/">plot shortcode</a>. This is cool because allows me to generate complex structures like the category groupby from the previous example and display it here in a dynamic plot with just a copy/paste operation.</p>

<p>fist thing is to import the json package and modify the plot code like this.</p>

<pre><code class="language-py">def beds_vs_meanprice(df: pd.DataFrame):
    data = df.groupby([&quot;cancellation_policy&quot;,&quot;beds&quot;],as_index=False)[&quot;price_value&quot;].mean()
    fig = {
        &quot;data&quot;:[
            {
                &quot;type&quot;: &quot;bar&quot;,
                &quot;x&quot;:data[data[&quot;cancellation_policy&quot;]==policy][&quot;beds&quot;].to_list(),
                &quot;y&quot;:data[data[&quot;cancellation_policy&quot;]==policy][&quot;price_value&quot;].to_list(),
                &quot;name&quot;:policy
            } for policy in data[&quot;cancellation_policy&quot;].unique()
        ]
    }
    print(json.dumps(fig))
    pio.show(fig)
beds_vs_meanprice(df)
</code></pre>

<p>the <code>to_list()</code> is important because if not, the json generated contains the dataframe data. Then the <code>json.dumps</code> just works. Here is the output.</p>

<pre><code class="language-json">{
    &quot;data&quot;: [
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16 ],
            &quot;y&quot;: [ 58.049180327868854, 137.5415173237754, 138.96512935883015, 393.92602040816325, 293.5128205128205, 357.9247311827957, 210.82432432432432, 155.11764705882354, 1966.3333333333333, 358.42857142857144, 1050.3846153846155, 4160, 454.75, 146, 805
            ],
            &quot;name&quot;: &quot;flexible&quot;
        },
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 26, 28 ],
            &quot;y&quot;: [ 89.23809523809524, 65.87909209951987, 116.96257796257797, 187.15055467511885, 208.99554565701558, 189.24479166666666, 258.75, 387.48936170212767, 256.4347826086956, 431.75, 258, 30, 107.5, 899, 20, 25, 300, 740, 15 ],
            &quot;name&quot;: &quot;moderate&quot;
        },
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 1 ],
            &quot;y&quot;: [ 42.5 ],
            &quot;name&quot;: &quot;strict&quot;
        },
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 23, 24, 25, 30 ],
            &quot;y&quot;: [ 183.8181818181818, 64.93736903376019, 99.97269624573379, 138.1967654986523, 161.53831231813774, 160.23861566484518, 210.30085959885386, 214.05797101449275, 257.85714285714283, 385.0833333333333, 328.4375, 383.5, 361.2857142857143, 542.5, 342.4, 391.42857142857144, 484.44444444444446, 580, 628, 453, 500, 550, 545.5, 483 ],
            &quot;name&quot;: &quot;strict_14_with_grace_period&quot;
        },
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 1, 2, 3, 4, 5, 6, 7, 8 ],
            &quot;y&quot;: [ 625.6923076923077, 222.1764705882353, 615.170731707317, 386.4418604651163, 234.85714285714286, 236.15384615384616, 374.75, 1092.25 ],
            &quot;name&quot;: &quot;super_strict_30&quot;
        },
        {
            &quot;type&quot;: &quot;bar&quot;,
            &quot;x&quot;: [ 1, 2, 3, 4 ],
            &quot;y&quot;: [ 595.6666666666666, 200, 361.6666666666667, 700.25 ],
            &quot;name&quot;: &quot;super_strict_60&quot;
        }
    ]
}
</code></pre>

<p>using this json body in the plot shortcode, generates the graph above.</p>

<p>This is not the only way of generating json. The package plotly.io has an option <code>pio.to_json</code> that is much more robust. This function handles the dataframes without the <code>to_list</code> option and also prints style configuration. The only drawback is that the output is much bigger. This is the plot generated from that json.</p>

<div class="figure">
<div class="figure-plot" id="plot3">
	Code could not finish, this are some reasons why this happen.
	- Plot name not defined. The first parameter of the shortcode is the name.
	- There is a syntax error. check browser console.
</div>
<script>
  function draw(){
	test = document.getElementById("plot3");
	if (test == null){
		console.log("The plot name is not defined")
		return
	}

	fig = null
	
fig = {"data":[{"name":"flexible","type":"bar","x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,12.0,14.0,15.0,16.0],"y":[58.049180327868854,137.5415173237754,138.96512935883015,393.92602040816325,293.5128205128205,357.9247311827957,210.82432432432432,155.11764705882354,1966.3333333333333,358.42857142857144,1050.3846153846155,4160.0,454.75,146.0,805.0]},{"name":"moderate","type":"bar","x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,16.0,18.0,26.0,28.0],"y":[89.23809523809524,65.87909209951987,116.96257796257797,187.15055467511885,208.99554565701558,189.24479166666666,258.75,387.48936170212767,256.4347826086956,431.75,258.0,30.0,107.5,899.0,20.0,25.0,300.0,740.0,15.0]},{"name":"strict","type":"bar","x":[1.0],"y":[42.5]},{"name":"strict_14_with_grace_period","type":"bar","x":[0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,18.0,19.0,20.0,23.0,24.0,25.0,30.0],"y":[183.8181818181818,64.93736903376019,99.97269624573379,138.1967654986523,161.53831231813774,160.23861566484518,210.30085959885386,214.05797101449275,257.85714285714283,385.0833333333333,328.4375,383.5,361.2857142857143,542.5,342.4,391.42857142857144,484.44444444444446,580.0,628.0,453.0,500.0,550.0,545.5,483.0]},{"name":"super_strict_30","type":"bar","x":[1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0],"y":[625.6923076923077,222.1764705882353,615.170731707317,386.4418604651163,234.85714285714286,236.15384615384616,374.75,1092.25]},{"name":"super_strict_60","type":"bar","x":[1.0,2.0,3.0,4.0],"y":[595.6666666666666,200.0,361.6666666666667,700.25]}],"layout":{"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}}}


	if (!fig) {
		test.innerText = "ERROR: fig variable is not defined"
		return
	}
	test.innerText = null
	Plotly.plot(test ,fig);
  }
  draw()
</script>
</div>

<h2 id="docker-compose-recipe">docker-compose recipe</h2>

<p>And to finish this howto, I&rsquo;m going to leave a repository with a docker-compose configured to create this environment. This way, you can easily create the environment wherever you want. It also includes a volume under the work folder to ensure that your notebooks survive when you stop the container.</p>

<p>Just keep in mind that this is a basic template. You will need to modify it to include credentials, other libraries, more extenssions&hellip; whatever you want.</p>

<p><a href="https://github.com/MetalBlueberry/juypterLabTemplate">check it out here</a></p>

<p>Now just run this, and you are ready to code!</p>

<pre><code class="language-sh">docker-compose up --build lab
</code></pre>

<h2 id="conclussion">Conclussion</h2>

<p>If you are planning to understand some data, you should start with an environment like this. With Pandas is really easy to transform data. With plotly you can create amazing interactive plots. And if you need anything else, remember that you are using Python and everything is already implemented in Python.</p>

<p>Thank you for reading and feel free to leave a comment bellow, I will be really happy to hear from you.</p>

<h2 id="references">References</h2>

<ul>
<li><a href="https://jupyter-docker-stacks.readthedocs.io/en/latest/">Jupyter Docker Stacks</a></li>
<li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference</a></li>
<li><a href="https://plot.ly/python/creating-and-updating-figures/">Creating and Updating Figures</a></li>
<li><a href="https://plot.ly/python/renderers/">Plotly renderers</a></li>
</ul>

<p>extra</p>

<ul>
<li><a href="https://plot.ly/python/jupyter-lab-tools/">JupyterLab Interactive</a></li>
</ul></article><section class="article labels"><a class="category" href=/categories/howto/>howto</a><a class="tag" href=/tags/python/>python</a><a class="tag" href=/tags/plotly/>plotly</a></section></div><section class="article navigation"><p><a class="link" href="/post/blog/2019-12-09_weekend_learnings/"><span class="li">&larr;</span>2019-12-09 Weekend Learnings</a></p><p><a class="link" href="/post/howto/2019-11-23_add_plots_with_hugo_shortcodes/"><span class="li">&rarr;</span>Add Plots With Hugo Shortcodes - Plotly</a></p></section><script src="https://utteranc.es/client.js" repo="MetalBlueberry/MetalBlueberry.github.io" issue-term="og:title"
    label="comment" theme="github-light" crossorigin="anonymous" async>
    </script></div><section id="footer" class="footer"><div class="footer-wrap">
    <p class="copyright">Víctor Pérez Domingo</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></section>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-150427130-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</div>
</body>

</html>